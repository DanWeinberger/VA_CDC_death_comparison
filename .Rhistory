aggr_summary <- detailed_summary %>%
group_by(agec,race_recode, date) %>%
mutate(race_recode=factor(race_recode, c('1','2','3','4','5'), c('White','Black' ,'Hispanic','Amer.Indian','Asian/PacifIs'))) %>%
summarize(N_non_covid_excess=sum(N_non_covid_excess), pop.interpol=sum(pop.interpol), excess_deaths=sum(excess_deaths), N_covid=sum(N_covid)) %>%
mutate( non_covid_excess_rate= N_non_covid_excess/pop.interpol*100000,
excess_death_rate= excess_deaths/pop.interpol*100000,
covid_death_rate= N_covid/pop.interpol*100000
)
blank_data <- data.frame(agec = c('25-44 years', '45-64 years', '65-74 years', '75-84 years', '85 years and older'),x=as.Date('2014-01-01'), y= c(50,150,350,600, 1200))
p3a <- ggplot(aggr_summary, aes(x=date, y=non_covid_excess_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause minus COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3a
blank_data <- data.frame(agec = c('25-44 years', '45-64 years', '65-74 years', '75-84 years', '85 years and older'),x=as.Date('2020-01-01'), y= c(50,150,350,600, 1200))
p3a <- ggplot(aggr_summary, aes(x=date, y=non_covid_excess_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause minus COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3a
p3a <- ggplot(aggr_summary, aes(x=date, y=non_covid_excess_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause minus COVID deaths/100000')
p3a
p3+
geom_blank(data = blank_data, aes(x = x, y = y))
p3a+
geom_blank(data = blank_data, aes(x = x, y = y))
blank_data <- data.frame(agec = c('25-44 years', '45-64 years', '65-74 years', '75-84 years', '85 years and older'),race_recode= unique(aggr_summary$race_recode), x=as.Date('2020-01-01'), y= c(50,150,350,600, 1200))
p3a <- ggplot(aggr_summary, aes(x=date, y=non_covid_excess_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause minus COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3a
aggr_summary <- detailed_summary %>%
group_by(agec,race_recode, date) %>%
mutate(race_recode=factor(race_recode, c('1','2','3','4','5'), c('White','Black' ,'Hispanic','Amer.Indian','Asian/PacifIs'))) %>%
summarize(N_non_covid_excess=sum(N_non_covid_excess), pop.interpol=sum(pop.interpol), excess_deaths=sum(excess_deaths), N_covid=sum(N_covid)) %>%
mutate( non_covid_excess_rate= N_non_covid_excess/pop.interpol*100000,
excess_death_rate= excess_deaths/pop.interpol*100000,
covid_death_rate= N_covid/pop.interpol*100000
)
blank_data <- data.frame(agec = c('25-44 years', '45-64 years', '65-74 years', '75-84 years', '85 years and older'),race_recode= unique(aggr_summary$race_recode), x=as.Date('2020-01-01'), y= c(50,150,350,600, 1200))
p3a <- ggplot(aggr_summary, aes(x=date, y=non_covid_excess_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause minus COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b <- ggplot(aggr_summary, aes(x=date, y=excess_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3c <- ggplot(aggr_summary, aes(x=date, y=covid_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b/p3c/p3a
p3b/p3c/p3a
aggr_summary <- detailed_summary %>%
group_by(agec,race_recode, date) %>%
mutate(race_recode=factor(race_recode, c('1','2','3','4','5'), c('White','Black' ,'Hispanic','Amer.Indian','Asian/PacifIs'))) %>%
summarize(N_non_covid_excess=sum(N_non_covid_excess), pop.interpol=sum(pop.interpol), excess_deaths=sum(excess_deaths), N_covid=sum(N_covid)) %>%
mutate( non_covid_excess_rate= N_non_covid_excess/pop.interpol*100000,
excess_death_rate= excess_deaths/pop.interpol*100000,
covid_death_rate= N_covid/pop.interpol*100000
)
blank_data <- data.frame(agec = c('25-44 years', '45-64 years', '65-74 years', '75-84 years', '85 years and older'),race_recode= unique(aggr_summary$race_recode), x=as.Date('2020-01-01'), y= c(50,150,350,600, 1200))
p3a <- ggplot(aggr_summary, aes(x=date, y=non_covid_excess_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause minus COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b <- ggplot(aggr_summary, aes(x=date, y=excess_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3c <- ggplot(aggr_summary, aes(x=date, y=covid_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b/p3c/p3a
aggr_summary <- detailed_summary %>%
group_by(agec,race_recode, date) %>%
mutate(race_recode=factor(race_recode, c('1','2','3','4','5'), c('White','Black' ,'Hispanic','Amer.Indian','Asian/PacifIs'))) %>%
summarize(N_non_covid_excess=sum(N_non_covid_excess), pop.interpol=sum(pop.interpol), excess_deaths=sum(excess_deaths), N_covid=sum(N_covid)) %>%
mutate( non_covid_excess_rate= N_non_covid_excess/pop.interpol*100000,
excess_death_rate= excess_deaths/pop.interpol*100000,
covid_death_rate= N_covid/pop.interpol*100000
)
blank_data <- data.frame(agec = c('25-44 years', '45-64 years', '65-74 years', '75-84 years', '85 years and older'),race_recode= unique(aggr_summary$race_recode), x=as.Date('2020-01-01'), y= c(60,150,350,600, 1200))
p3a <- ggplot(aggr_summary, aes(x=date, y=non_covid_excess_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause minus COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b <- ggplot(aggr_summary, aes(x=date, y=excess_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3c <- ggplot(aggr_summary, aes(x=date, y=covid_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b/p3c/p3a
aggr_summary <- detailed_summary %>%
group_by(agec,race_recode, date) %>%
mutate(race_recode=factor(race_recode, c('1','2','3','4','5'), c('White','Black' ,'Hispanic','Amer.Indian','Asian/PacifIs'))) %>%
summarize(N_non_covid_excess=sum(N_non_covid_excess), pop.interpol=sum(pop.interpol), excess_deaths=sum(excess_deaths), N_covid=sum(N_covid)) %>%
mutate( non_covid_excess_rate= N_non_covid_excess/pop.interpol*100000,
excess_death_rate= excess_deaths/pop.interpol*100000,
covid_death_rate= N_covid/pop.interpol*100000
)
blank_data <- data.frame(agec = c('25-44 years', '45-64 years', '65-74 years', '75-84 years', '85 years and older'),race_recode= unique(aggr_summary$race_recode), x=as.Date('2020-01-01'), y= c(60,150,350,600, 1250))
p3a <- ggplot(aggr_summary, aes(x=date, y=non_covid_excess_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause minus COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b <- ggplot(aggr_summary, aes(x=date, y=excess_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3c <- ggplot(aggr_summary, aes(x=date, y=covid_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b/p3c/p3a
aggr_summary <- detailed_summary %>%
group_by(agec,race_recode, date) %>%
mutate(race_recode=factor(race_recode, c('1','2','3','4','5'), c('White','Black' ,'Hispanic','Amer.Indian','Asian/PacifIs'))) %>%
summarize(N_non_covid_excess=sum(N_non_covid_excess), pop.interpol=sum(pop.interpol), excess_deaths=sum(excess_deaths), N_covid=sum(N_covid)) %>%
mutate( non_covid_excess_rate= N_non_covid_excess/pop.interpol*100000,
excess_death_rate= excess_deaths/pop.interpol*100000,
covid_death_rate= N_covid/pop.interpol*100000
)
blank_data <- data.frame(agec = c('25-44 years', '45-64 years', '65-74 years', '75-84 years', '85 years and older'),race_recode= unique(aggr_summary$race_recode), x=as.Date('2020-01-01'), y= c(60,150,350,600, 1500))
p3a <- ggplot(aggr_summary, aes(x=date, y=non_covid_excess_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause minus COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b <- ggplot(aggr_summary, aes(x=date, y=excess_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3c <- ggplot(aggr_summary, aes(x=date, y=covid_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b/p3c/p3a
aggr_summary_NE <- detailed_summary %>%
filter(region=='Northeast') %>%
group_by(agec,race_recode, date) %>%
mutate(race_recode=factor(race_recode, c('1','2','3','4','5'), c('White','Black' ,'Hispanic','Amer.Indian','Asian/PacifIs'))) %>%
summarize(N_non_covid_excess=sum(N_non_covid_excess), pop.interpol=sum(pop.interpol), excess_deaths=sum(excess_deaths), N_covid=sum(N_covid)) %>%
mutate( non_covid_excess_rate= N_non_covid_excess/pop.interpol*100000,
excess_death_rate= excess_deaths/pop.interpol*100000,
covid_death_rate= N_covid/pop.interpol*100000
)
blank_data <- data.frame(agec = c('25-44 years', '45-64 years', '65-74 years', '75-84 years', '85 years and older'),race_recode= unique(aggr_summary_NE$race_recode), x=as.Date('2020-01-01'), y= c(60,150,350,600, 1500))
p3a <- ggplot(aggr_summary_NE, aes(x=date, y=non_covid_excess_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause minus COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b <- ggplot(aggr_summary_NE, aes(x=date, y=excess_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3c <- ggplot(aggr_summary_NE, aes(x=date, y=covid_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b/p3c/p3a
aggr_summary_S <- detailed_summary %>%
filter(region=='South') %>%
group_by(agec,race_recode, date) %>%
mutate(race_recode=factor(race_recode, c('1','2','3','4','5'), c('White','Black' ,'Hispanic','Amer.Indian','Asian/PacifIs'))) %>%
summarize(N_non_covid_excess=sum(N_non_covid_excess), pop.interpol=sum(pop.interpol), excess_deaths=sum(excess_deaths), N_covid=sum(N_covid)) %>%
mutate( non_covid_excess_rate= N_non_covid_excess/pop.interpol*100000,
excess_death_rate= excess_deaths/pop.interpol*100000,
covid_death_rate= N_covid/pop.interpol*100000
)
aggr_summary_S <- detailed_summary %>%
filter(region=='South') %>%
group_by(agec,race_recode, date) %>%
mutate(race_recode=factor(race_recode, c('1','2','3','4','5'), c('White','Black' ,'Hispanic','Amer.Indian','Asian/PacifIs'))) %>%
summarize(N_non_covid_excess=sum(N_non_covid_excess), pop.interpol=sum(pop.interpol), excess_deaths=sum(excess_deaths), N_covid=sum(N_covid)) %>%
mutate( non_covid_excess_rate= N_non_covid_excess/pop.interpol*100000,
excess_death_rate= excess_deaths/pop.interpol*100000,
covid_death_rate= N_covid/pop.interpol*100000
)
blank_data <- data.frame(agec = c('25-44 years', '45-64 years', '65-74 years', '75-84 years', '85 years and older'),race_recode= unique(aggr_summary_S$race_recode), x=as.Date('2020-01-01'), y= c(60,150,350,600, 1500))
p3a <- ggplot(aggr_summary_S, aes(x=date, y=non_covid_excess_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause minus COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b <- ggplot(aggr_summary_S, aes(x=date, y=excess_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3c <- ggplot(aggr_summary_S, aes(x=date, y=covid_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b/p3c/p3a
aggr_summary_NE <- detailed_summary %>%
filter(region=='Northeast') %>%
group_by(agec,race_recode, date) %>%
mutate(race_recode=factor(race_recode, c('1','2','3','4','5'), c('White','Black' ,'Hispanic','Amer.Indian','Asian/PacifIs'))) %>%
summarize(N_non_covid_excess=sum(N_non_covid_excess), pop.interpol=sum(pop.interpol), excess_deaths=sum(excess_deaths), N_covid=sum(N_covid)) %>%
mutate( non_covid_excess_rate= N_non_covid_excess/pop.interpol*100000,
excess_death_rate= excess_deaths/pop.interpol*100000,
covid_death_rate= N_covid/pop.interpol*100000
)
blank_data <- data.frame(agec = c('25-44 years', '45-64 years', '65-74 years', '75-84 years', '85 years and older'),race_recode= unique(aggr_summary_NE$race_recode), x=as.Date('2020-01-01'), y= c(60,200,600,1500, 3000))
p3a <- ggplot(aggr_summary_NE, aes(x=date, y=non_covid_excess_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause minus COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b <- ggplot(aggr_summary_NE, aes(x=date, y=excess_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3c <- ggplot(aggr_summary_NE, aes(x=date, y=covid_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b/p3c/p3a
aggr_summary_S <- detailed_summary %>%
filter(region=='Midwest') %>%
group_by(agec,race_recode, date) %>%
mutate(race_recode=factor(race_recode, c('1','2','3','4','5'), c('White','Black' ,'Hispanic','Amer.Indian','Asian/PacifIs'))) %>%
summarize(N_non_covid_excess=sum(N_non_covid_excess), pop.interpol=sum(pop.interpol), excess_deaths=sum(excess_deaths), N_covid=sum(N_covid)) %>%
mutate( non_covid_excess_rate= N_non_covid_excess/pop.interpol*100000,
excess_death_rate= excess_deaths/pop.interpol*100000,
covid_death_rate= N_covid/pop.interpol*100000
)
blank_data <- data.frame(agec = c('25-44 years', '45-64 years', '65-74 years', '75-84 years', '85 years and older'),race_recode= unique(aggr_summary_S$race_recode), x=as.Date('2020-01-01'), y= c(60,150,350,600, 1500))
p3a <- ggplot(aggr_summary_S, aes(x=date, y=non_covid_excess_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause minus COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b <- ggplot(aggr_summary_S, aes(x=date, y=excess_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3c <- ggplot(aggr_summary_S, aes(x=date, y=covid_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b/p3c/p3a
aggr_summary_S <- detailed_summary %>%
filter(region=='West') %>%
group_by(agec,race_recode, date) %>%
mutate(race_recode=factor(race_recode, c('1','2','3','4','5'), c('White','Black' ,'Hispanic','Amer.Indian','Asian/PacifIs'))) %>%
summarize(N_non_covid_excess=sum(N_non_covid_excess), pop.interpol=sum(pop.interpol), excess_deaths=sum(excess_deaths), N_covid=sum(N_covid)) %>%
mutate( non_covid_excess_rate= N_non_covid_excess/pop.interpol*100000,
excess_death_rate= excess_deaths/pop.interpol*100000,
covid_death_rate= N_covid/pop.interpol*100000
)
blank_data <- data.frame(agec = c('25-44 years', '45-64 years', '65-74 years', '75-84 years', '85 years and older'),race_recode= unique(aggr_summary_S$race_recode), x=as.Date('2020-01-01'), y= c(60,150,350,600, 1500))
p3a <- ggplot(aggr_summary_S, aes(x=date, y=non_covid_excess_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause minus COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b <- ggplot(aggr_summary_S, aes(x=date, y=excess_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('Excess all-cause deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3c <- ggplot(aggr_summary_S, aes(x=date, y=covid_death_rate, group=race_recode, col=race_recode, lty=race_recode)) +
geom_line() +
theme_classic() +
ylab('Deaths/100000')+
facet_wrap(~agec, scales='free', nrow=1)+
ggtitle('COVID deaths/100000')+
geom_blank(data = blank_data, aes(x = x, y = y))
p3b/p3c/p3a
library(readxl)
library(cdcfluview)
library(reshape2)
library(ggplot2)
library(lubridate)
library(RColorBrewer)
library(plotly)
library(MMWRweek)
library(readr)
library(rjson)
library(parallel)
library(htmlTable)
library(RSocrata)
library(pdftools)
library(readr)
library(patchwork)
library(abind)
library(INLA)
library(gsubfn)
library(dplyr)
library(RCurl)
library(dplyr)
library(tidyverse)
library(gifski)
library(gganimate)
library(shiny)
library(INLA)
library(lme4)
library(pbapply)
#library(jsonlite)
set.seed(123)
source('./R/read_dependent_scripts.R')
#std.pop.age.region.sex.race <- readRDS('./Data/std.pop.age.region.sex.race.rds')
std.pop.VA.age.region.sex.race <- readRDS('./Data/std.pop.VAenrollees.age.region.sex.race.rds')
out.ds <-readRDS('./outputs/out.ds.cdc.rds')
results <- readRDS('./outputs/summary_list_cdc.rds')
extract_func(results, measure= 'RR', round.level = 2 )
extract_func(results, measure= 'RR_std', round.level = 2 )
extract_func(results, measure= 'excess_inc', round.level = 0 )
extract_func(results, measure= 'excess_std_inc', round.level = 0 )
extract_func(results, measure= 'pred_inc', round.level = 0 )
extract_func(results, measure= 'expected_std_inc', round.level = 0 )
extract_func(results, measure= 'expected_std_inc', round.level = 0 )
results$preds.overall$obs_inc
results$preds.overall$obs_std_inc
str(results)
names(results)
results$preds.age.overall
View(results$preds.age.overall)
results$preds.age.overall %>%
select(agec, N_deaths, excess_median)
results$preds.age.overall %>%
select(agec, N_deaths, excess_median) %>%
mutate(excess_median=round(excess_median))
htmlTable(results$preds.age.overall %>%
select(agec, N_deaths, excess_median) %>%
mutate(excess_median=round(excess_median)))
htmlTable(results$preds.age.overall %>%
select(agec,  excess_median) %>%
mutate(excess_median=round(excess_median)))
knitr::opts_chunk$set(
collapse = TRUE,
echo=F,
warning=FALSE,
message=FALSE,
comment = "#>",
dev=c('png','pdf'),
fig.path='./figures/',
gganimate = list(
nframes = 50)
)
library(readxl)
library(reshape2)
library(ggplot2)
library(lubridate)
library(RColorBrewer)
library(plotly)
library(MMWRweek)
library(readr)
library(zoo)
library(rjson)
library(parallel)
library(htmlTable)
library(RSocrata)
library(pdftools)
library(readr)
library(patchwork)
library(abind)
library(INLA)
library(gsubfn)
library(dplyr)
library(RCurl)
library(dplyr)
library(tidyverse)
library(gridExtra)
library(gifski)
library(gganimate)
library(shiny)
library(INLA)
library(lme4)
library(pbapply)
#library(jsonlite)
set.seed(123)
source('./R/read_dependent_scripts.R')
cdc<- readRDS('./outputs/summary_list_cdc.rds')
va.full <- readRDS('./outputs/confidential/outputs_all/summary_list_va.rds')
#VA active users using Christopher's definition
va.users.cr <- readRDS('./outputs/confidential/outputs_users_CR_definition/summary_list_va.rds')
#Liam's definition of active user (most stringent inclusion criteria)
va.users.lr <- readRDS('./outputs/confidential/outputs_users_LR_definition/summary_list_va.rds')
htmlTable(va.users.cr$preds.age.overall %>%
select(agec,  excess_median) %>%
mutate(excess_median=round(excess_median)))
names(va.users.cr$preds.age.sex.overall )
View(va.users.cr$preds.age.race.region)
names(va.users.cr$preds.age.sex.overall)
names(va.users.cr$preds.age.race.region)
va.users.cr$preds.age.race.region %>%
select(agec,  sex, excess_median) %>%
mutate(excess_deaths=excess_inc_median*pop/100000 ) %>%
filter(date>='2020-04-01') %>%
group_by(agec, race_recode, region, sex) %>%
summarize(excess_deaths=sum(excess_deaths))
va.users.cr$preds.age.race.region %>%
mutate(excess_deaths=excess_inc_median*pop/100000 ) %>%
filter(date>='2020-04-01') %>%
group_by(agec, race_recode, region, sex) %>%
summarize(excess_deaths=sum(excess_deaths))
summary_deaths <- va.users.cr$preds.age.race.region %>%
mutate(excess_deaths=excess_inc_median*pop/100000 ) %>%
filter(date>='2020-04-01') %>%
group_by(agec, race_recode, region, sex) %>%
summarize(excess_deaths=sum(excess_deaths))
write.csv(summary_deaths, './outputs/summary_excess_group.csv')
View(summary_deaths)
summary_deaths <- va.users.cr$preds.age.race.region %>%
mutate(excess_deaths=excess_inc_median*pop/100000 ) %>%
filter(date>='2020-04-01') %>%
group_by(agec, race_recode, region, sex) %>%
summarize(excess_deaths=round(sum(excess_deaths)))
write.csv(summary_deaths, './outputs/summary_excess_group.csv')
